# Default values for id-generator

replicaCount: 3

image:
  repository: ghcr.io/Edthing/id-generator
  tag: "" # Defaults to chart appVersion
  pullPolicy: IfNotPresent

# Removed useWrapper and wrapperImage since functionality is integrated

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

service:
  type: ClusterIP
  port: 8080

# Headless service is always created for StatefulSet
# This controls an additional load-balanced service
loadBalancer:
  enabled: true
  type: ClusterIP  # ClusterIP, LoadBalancer, or NodePort
  annotations: {}

resources:
  requests:
    memory: "64Mi"
    cpu: "100m"
  limits:
    memory: "128Mi"
    cpu: "500m"

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10  # Keep within worker ID space (typically 1024 max)
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80
  keda:
    enabled: true
    prometheusServerAddress: http://prometheus-server.monitoring.svc.cluster.local
    threshold: "5"
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Pods
          value: 1
          periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 0
      policies:
        - type: Pods
          value: 2
          periodSeconds: 30

# Pod configuration
podAnnotations: {}
podLabels: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext:
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

nodeSelector: {}

tolerations: []

affinity: {}

# Probes
livenessProbe:
  enabled: true
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 5
  periodSeconds: 10

readinessProbe:
  enabled: true
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 5
  periodSeconds: 5

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1
  # maxUnavailable: 1

# ServiceMonitor for Prometheus
serviceMonitor:
  enabled: false
  interval: 30s
  scrapeTimeout: 10s
  labels: {}
